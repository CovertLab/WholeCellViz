(function(e){e.fn.numeric=function(t,n){if(typeof t==="boolean"){t={decimal:t}}t=t||{};if(typeof t.negative=="undefined"){t.negative=true}var r=t.decimal===false?"":t.decimal||".";var i=t.negative===true?true:false;n=typeof n=="function"?n:function(){};return this.data("numeric.decimal",r).data("numeric.negative",i).data("numeric.callback",n).keypress(e.fn.numeric.keypress).keyup(e.fn.numeric.keyup).blur(e.fn.numeric.blur)};e.fn.numeric.keypress=function(t){var n=e.data(this,"numeric.decimal");var r=e.data(this,"numeric.negative");var i=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i==13&&this.nodeName.toLowerCase()=="input"){return true}else if(i==13){return false}var s=false;if(t.ctrlKey&&i==97||t.ctrlKey&&i==65){return true}if(t.ctrlKey&&i==120||t.ctrlKey&&i==88){return true}if(t.ctrlKey&&i==99||t.ctrlKey&&i==67){return true}if(t.ctrlKey&&i==122||t.ctrlKey&&i==90){return true}if(t.ctrlKey&&i==118||t.ctrlKey&&i==86||t.shiftKey&&i==45){return true}if(i<48||i>57){var o=e(this).val();if(o.indexOf("-")!==0&&r&&i==45&&(o.length===0||parseInt(e.fn.getSelectionStart(this),10)===0)){return true}if(n&&i==n.charCodeAt(0)&&o.indexOf(n)!=-1){s=false}if(i!=8&&i!=9&&i!=13&&i!=35&&i!=36&&i!=37&&i!=39&&i!=46){s=false}else{if(typeof t.charCode!="undefined"){if(t.keyCode==t.which&&t.which!==0){s=true;if(t.which==46){s=false}}else if(t.keyCode!==0&&t.charCode===0&&t.which===0){s=true}}}if(n&&i==n.charCodeAt(0)){if(o.indexOf(n)==-1){s=true}else{s=false}}}else{s=true}return s};e.fn.numeric.keyup=function(t){var n=e(this).val();if(n&&n.length>0){var r=e.fn.getSelectionStart(this);var i=e.fn.getSelectionEnd(this);var s=e.data(this,"numeric.decimal");var o=e.data(this,"numeric.negative");if(s!==""&&s!==null){var u=n.indexOf(s);if(u===0){this.value="0"+n}if(u==1&&n.charAt(0)=="-"){this.value="-0"+n.substring(1)}n=this.value}var a=[0,1,2,3,4,5,6,7,8,9,"-",s];var f=n.length;for(var l=f-1;l>=0;l--){var c=n.charAt(l);if(l!==0&&c=="-"){n=n.substring(0,l)+n.substring(l+1)}else if(l===0&&!o&&c=="-"){n=n.substring(1)}var h=false;for(var p=0;p<a.length;p++){if(c==a[p]){h=true;break}}if(!h||c==" "){n=n.substring(0,l)+n.substring(l+1)}}var d=n.indexOf(s);if(d>0){for(var v=f-1;v>d;v--){var m=n.charAt(v);if(m==s){n=n.substring(0,v)+n.substring(v+1)}}}this.value=n;e.fn.setSelection(this,[r,i])}};e.fn.numeric.blur=function(){var t=e.data(this,"numeric.decimal");var n=e.data(this,"numeric.callback");var r=this.value;if(r!==""){var i=new RegExp("^\\d+$|^\\d*"+t+"\\d+$");if(!i.exec(r)){n.apply(this)}}};e.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).unbind("keypress",e.fn.numeric.keypress).unbind("blur",e.fn.numeric.blur)};e.fn.getSelectionStart=function(e){if(e.createTextRange){var t=document.selection.createRange().duplicate();t.moveEnd("character",e.value.length);if(t.text===""){return e.value.length}return e.value.lastIndexOf(t.text)}else{return e.selectionStart}};e.fn.getSelectionEnd=function(e){if(e.createTextRange){var t=document.selection.createRange().duplicate();t.moveStart("character",-e.value.length);return t.text.length}else return e.selectionEnd};e.fn.setSelection=function(e,t){if(typeof t=="number"){t=[t,t]}if(t&&t.constructor==Array&&t.length==2){if(e.createTextRange){var n=e.createTextRange();n.collapse(true);n.moveStart("character",t[0]);n.moveEnd("character",t[1]);n.select()}else if(e.setSelectionRange){e.focus();e.setSelectionRange(t[0],t[1])}}}})(jQuery)